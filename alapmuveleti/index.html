<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Alapm≈±veleti teszt</title>
  <style>

    table {
      border: none;
      border-collapse: collapse; 
      table-layout: fixed;
      width: 100%;  
      margin-top: 1cm;
      /*margin: 1cm;*/
    } 
     
    th,td {
      border: none; /* 1px solid; */
      font-size:  18pt;
      font-family: Arial;
      height:  28pt;
    }

  </style>
</head>

<body>

  <table id='table' />
  <script src="https://randojs.com/2.0.0.js"></script>  
  <script>
    const min_num = 2; 
    const max_num = 20;

    const url_params = new URLSearchParams(window.location.search);
    const mixed_param = url_params.get('mixed');
    var mixed_operations = (mixed_param != null) && (mixed_param != 0);


    // NOTE: the number of all possible operations is quite small (231 for all possibilities, and 190: if you exclude 0 and 1)
    // this makes pregenerating all possible combinations viable
    var crossing_10s, not_crossing_10s;
    {
      // a,b,c, so that: min_num <= a, b <= c <= max_num and a + b = c
      let a, b, c;
      crossing_10s = [];
      not_crossing_10s = [];
      for (c = 2 * min_num; c <= max_num; c++) {
        for (a = min_num; a <= c - min_num; a++) {
          b = c - a;
          if ((a < 10) && (b < 10) && (c > 10)) {
            crossing_10s.push({a, b, c});
          } else {
            not_crossing_10s.push({a, b, c});
          }
        }
      }
    }

    // returns the elements of a sequence in a random order
    class InRandomOrder {
      constructor(sequence) {
          this.sequence = randoSequence(sequence);
          this.next_i = 0; // next index in the sequence
      }

      next() {
          let i = this.next_i;
          this.next_i = (this.next_i + 1) % this.sequence.length;
          return this.sequence[i].value;
      }
    }

    var crossing_10_addition = new InRandomOrder(crossing_10s)
    var crossing_10_subtraction = new InRandomOrder(crossing_10s)
    var not_crossing_10_addition = new InRandomOrder(not_crossing_10s)
    var not_crossing_10_subtraction = new InRandomOrder(not_crossing_10s)



    function get_operation(x, y) {
      // incerase the chance of "tizes atlepes"
      const crossing_10_chance_add = 0.5;
      const crossing_10_chance_sub = 0.0;
      if (mixed_operations) {
        var is_add = Math.random() < 0.5;
      } else {
        var is_add = (x < 2);
      }

      if (is_add) {
        if (Math.random() < crossing_10_chance_add) {
          var {a, b, c} = crossing_10_addition.next();
        } else {
          var {a, b, c} = not_crossing_10_addition.next();
        }
        return `${a} + ${b} =   `
      } else {
        if (Math.random() < crossing_10_chance_sub) {
          var {a, b, c} = crossing_10_subtraction.next();
        } else {
          do {
            var {a, b, c} = not_crossing_10_subtraction.next();
          } while ((c == 20) && (a > 10));
        }
        return `${c} - ${a} =   `
      }
    }

    var tbl = document.getElementById('table')
    for (let i = 0; i < 25; i++) {
      const tr = tbl.insertRow();
      for (let j = 0; j < 4; j++) {
          const td = tr.insertCell();
          td.appendChild(document.createTextNode(get_operation(j, i)));
      }
    }


  </script>  

</body>
</html>